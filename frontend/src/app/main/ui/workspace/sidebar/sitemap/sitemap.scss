// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this
// file, You can obtain one at http://mozilla.org/MPL/2.0/.
//
// Copyright (c) KALEIDOS INC

@import "refactor/common-refactor.scss";

.sitemap {
  position: relative;
  display: flex;
  flex-direction: column;
  flex: 1;
  width: 100%;
  height: var(--height, 200px);

  .pages-tool-bar {
    display: flex;
    align-items: center;
    min-height: $spacing-32;
    padding: 0 $spacing-12;
    .page-tool-bar-title {
      @include flexCenter;
      @include titleTipography;
      @include buttonStyle;
      flex-grow: 1;
      gap: $spacing-4;
      justify-content: flex-start;
      padding: 0;
      margin: 0;
      color: var(--title-foreground-color);
      .collapsable-button {
        @include flexCenter;
        height: $spacing-24;
        width: $spacing-24;
        border-radius: $br8;
        svg {
          @extend .button-icon;
          height: $spacing-12;
          width: $spacing-12;
          transform: rotate(90deg);
        }
      }
      &:hover {
        color: var(--title-foreground-color-hover);
        svg {
          stroke: var(--icon-foreground-hover);
        }
      }
    }
    .add-page {
      @extend .button-primary;
      height: $spacing-24;
      width: $spacing-24;
      border-radius: $br8;
      svg {
        @extend .button-icon;
        transform: rotate(90deg);
      }
    }
  }
  .resize-area {
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 100%;
    height: $spacing-12;
    border-top: 2px solid var(--color-background-secondary);
    background-color: var(--color-background-primary);
    cursor: ns-resize;
    &:hover {
      border-color: var(--color-background-quaternary);
    }
  }
  .tool-window-content {
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    overflow-x: hidden;
    height: 100%;
    width: 100%;

    .pages-list {
      width: 100%;
      max-height: $spacing-152;
      margin-bottom: $spacing-12;
      .page-element {
        @include titleTipography;
        min-height: $spacing-32;
        width: 100%;
        cursor: pointer;
        &.dnd-over-top {
          border-top: 1px solid var(--layer-row-foreground-color-drag);
        }
        &.dnd-over-bot {
          border-bottom: 1px solid var(--layer-row-foreground-color-drag);
        }
        .dnd-over > .element-list-body {
          border: 1px solid var(--layer-row-foreground-color-drag);
        }
        .element-list-body {
          display: flex;
          align-items: center;
          height: $spacing-32;
          width: 100%;
          padding: 0 $spacing-12;
          transition: none;
          color: var(--layer-row-foreground-color);
          .page-name {
            flex-grow: 1;
          }
          .page-icon {
            @include flexCenter;
            width: $spacing-24;
            svg {
              height: $spacing-12;
              width: $spacing-12;
              color: transparent;
              fill: none;
              stroke: var(--icon-foreground);
            }
          }
          .page-actions button {
            @include buttonStyle;
            @include flexCenter;
            width: $spacing-24;
            opacity: 0;
            svg {
              height: $spacing-12;
              width: $spacing-12;
              color: transparent;
              fill: none;
              stroke: var(--icon-foreground);
            }
          }
          .element-name {
            color: var(--color-foreground-primary);
          }
        }
        &:active,
        &.on-drag {
          .element-list-body {
            color: var(--layer-row-foreground-color-drag);
            background-color: var(--layer-row-background-color-drag);
            .page-actions button {
              svg {
                stroke: var(--layer-row-foreground-color-drag);
              }
            }
            .page-icon svg {
              stroke: var(--layer-row-foreground-color-drag);
            }
          }
        }
        &.selected {
          .element-list-body {
            color: var(--layer-row-foreground-color-selected);
            background-color: var(--layer-row-background-color-selected);
            .page-actions button {
              svg {
                stroke: var(--layer-row-foreground-color-selected);
              }
            }
            .page-icon svg {
              stroke: var(--layer-row-foreground-color-selected);
            }
          }
        }
        &:hover {
          .element-list-body {
            color: var(--layer-row-foreground-color-hover);
            background-color: var(--layer-row-background-color-hover);
            .page-actions button {
              opacity: 1;
              svg {
                stroke: var(--layer-row-foreground-color-hover);
              }
            }
            .page-icon svg {
              stroke: var(--layer-row-foreground-color-hover);
            }
          }
        }
        &:focus {
          .element-list-body {
            color: var(--layer-row-foreground-color-focus);
            border: 1px solid var(--layer-row-border-color-focus);
            outline: none;
            .page-actions button {
              opacity: 1;
              svg {
                stroke: var(--layer-row-foreground-color-focus);
              }
            }
            .page-icon svg {
              stroke: var(--layer-row-foreground-color-focus);
            }
          }
        }
        &:focus-within {
          .element-list-body {
            outline: none;
            .page-actions button {
              opacity: 1;

              svg {
                stroke: var(--layer-row-foreground-color-focus);
              }
            }
            .page-icon svg {
              stroke: var(--layer-row-foreground-color-focus);
            }
          }
        }

        &.hidden {
          .element-list-body {
            color: var(--layer-row-foreground-color-hidden);
            background-color: var(--layer-row-background-color-hidden);
            opacity: 70%;
            .page-actions button {
              svg {
                stroke: var(--layer-row-foreground-color-hidden);
              }
            }
            .page-icon svg {
              stroke: var(--layer-row-foreground-color-hidden);
            }
          }
        }

        // &.open {
        //   ul {
        //     li {
        //       .element-list-body {
        //         border-style: dashed;
        //       }
        //     }
        //   }
        // }
      }
      // .context-menu {
      //   position: fixed;
      // }

      // .context-menu-items {
      //   border: none;
      //   margin: none;
      // }

      // .context-menu-action {
      //   width: 100%;
      // }
    }
  }
}
